/**
 * 
 * Plugin: WooCommerce Ultimate Multi Currency Suite
 * Author: http://dev49.net
 *
 */
function wcumcs_count_items(a){var c=0,b;for(b in a)a.hasOwnProperty(b)&&++c;return c}
function wcumcs_callback_action(a){if("string"===typeof a){var c=a;a={};a.name=c}var c=wcumcs_vars_data.wp_nonce,b={};if(null==a.name)return!1;if("restore_defaults"==a.name)if(confirm(wcumcs_vars_data.confirm_restore_defaults_msg))b={action:"wcumcs_ajax",verification:c,execute:"restore_defaults"},wcumcs_block_screen(!0),jQuery.post(ajaxurl,b,function(a){0>=a?alert(wcumcs_vars_data.operation_could_not_be_completed_msg):(alert(a),location.reload());wcumcs_block_screen(!1)});else return!1;else if("update_exchange_rates"==
a.name)b={action:"wcumcs_ajax",verification:c,execute:"update_exchange_rates",currency_data:a.currency_data},wcumcs_block_screen(!0),jQuery.post(ajaxurl,b,function(a){if(0>=a)alert(wcumcs_vars_data.operation_could_not_be_completed_msg);else{var b=jQuery.parseJSON(a),c=[];a=wcumcs_count_items(b);var f=1,k=1;jQuery.each(b,function(a){null!=b[a]&&(f=b[a].value,k=b[a].error);0==k?jQuery("#wcumcs_exchange_"+a+"_rate").val(f):c.push(a)});var g="";1==a?0<c.length&&(g=wcumcs_vars_data.error_currency_exchange_rate_update_msg+
c[0]):1<a?0<c.length?(g=wcumcs_vars_data.error_currency_exchange_rate_update_msg,jQuery.each(c,function(a){g+=c[a]+", "}),g=g.slice(0,-2)):g=wcumcs_vars_data.success_currency_exchange_rate_update_msg:g=wcumcs_vars_data.operation_could_not_be_completed_msg;0<g.length&&alert(g)}wcumcs_update_data();wcumcs_block_screen(!1)});else return!1}
function wcumcs_block_screen(a){1==a?(jQuery('<div id="wcumcs-block-div"></div>').appendTo("body"),jQuery("#wcumcs-block-div").css({opacity:0,width:jQuery(document).width(),height:jQuery(document).height()}),jQuery("#wcumcs-block-div").addClass("wcumcs-block-div"),jQuery("#wcumcs-block-div").animate({opacity:.4},150)):jQuery("#wcumcs-block-div").animate({opacity:0},150,function(){jQuery("#wcumcs-block-div").remove()})}
jQuery(document).ready(function(a){0<a("#wcumcs_remember_user_chosen_currency").length&&(wcumcs_conversion_mode_change(a("input[type=radio][name='wcumcs_conversion_method']:checked").val()),a("input[type=radio][name='wcumcs_conversion_method']").on("change",function(){wcumcs_conversion_mode_change(a(this).val())}),a("input[type=checkbox][name='wcumcs_checkout_total_in_base_currency']").on("change",function(){a(this).is(":checked")?a("#wcumcs_checkout_total_payment_text").removeAttr("disabled"):a("#wcumcs_checkout_total_payment_text").attr("disabled",
!0)}),a("input[type=submit][name='save']").on("click",function(){a("#wcumcs_checkout_total_payment_text").removeAttr("disabled");a("#wcumcs_checkout_total_in_base_currency").removeAttr("disabled");a("#wcumcs_predefined_prices").removeAttr("disabled")}))});
function wcumcs_conversion_mode_change(a){switch(a){case "reference":jQuery("#wcumcs_predefined_prices").attr("disabled",!0);jQuery("#wcumcs_checkout_total_in_base_currency").removeAttr("disabled");0<jQuery("input[type=checkbox][name='wcumcs_checkout_total_in_base_currency']:checked").length?jQuery("#wcumcs_checkout_total_payment_text").removeAttr("disabled"):jQuery("#wcumcs_checkout_total_payment_text").attr("disabled",!0);break;case "checkout":jQuery("#wcumcs_checkout_total_in_base_currency").attr("disabled",
!0),jQuery("#wcumcs_checkout_total_payment_text").attr("disabled",!0),jQuery("#wcumcs_predefined_prices").removeAttr("disabled")}}
jQuery(document).ready(function(a){if(0<a("#wcumcs_available_currencies").length){a(".wcumcs_new_currency").after('<a class="button" href="#onclick_action" style="width:320px;" onclick="wcumcs_add_new_currency_blob(jQuery(\'select.wcumcs_new_currency\').val());">'+wcumcs_vars_data.add_currency_to_list+"</a>");a("#wcumcs_available_currencies").after('<table class="wcumcs-currency-table" id="wcumcs_currency_table"></table>');a("#wcumcs_currency_table").append('<thead><tr><th class="wcumcs_currency_cell_code">'+
wcumcs_vars_data.currency_code+'</th><th class="wcumcs_currency_cell_name">'+wcumcs_vars_data.currency_name+'</th><th class="wcumcs_currency_cell_symbol">'+wcumcs_vars_data.currency_symbol+'</th><th class="wcumcs_currency_cell_position">'+wcumcs_vars_data.currency_position+'</th><th class="wcumcs_currency_cell_thousand">'+wcumcs_vars_data.thousand_separator+'</th><th class="wcumcs_currency_cell_decimal">'+wcumcs_vars_data.decimal_separator+'</th><th class="wcumcs_currency_cell_number">'+wcumcs_vars_data.number_decimals+
'</th><th class="wcumcs_currency_cell_remove">'+wcumcs_vars_data.remove_currency+"</th></tr></thead>");a("#wcumcs_currency_table").append("<tbody></tbody>");a("#wcumcs_currency_table tbody").sortable({helper:function(b,c){var e=c.children(),h=c.clone();h.children().each(function(b){a(this).width(e.eq(b).width())});return h},placeholder:"wcumcs_currencies_highlight",axis:"y",update:function(){wcumcs_update_currencies_list()}});var c=jQuery.parseJSON(a("#wcumcs_available_currencies").val());a.each(c,
function(a){wcumcs_add_new_currency(a,c[a],!0)})}});function wcumcs_add_new_currency_blob(a){a=a.split("#data_sep#");var c=a[0],b={};b.name=a[1];b.symbol=a[2];b.position=a[3];b.thousand_separator=a[4];b.decimal_separator=a[5];b.number_decimals=a[6];wcumcs_add_new_currency(c,b,!1)}
function wcumcs_add_new_currency(a,c,b){if(40<jQuery("#wcumcs_currency_table tr").length)alert(wcumcs_vars_data.too_many_currencies);else{var d=c.name,e=c.symbol,h=c.position,f=c.thousand_separator,k=c.decimal_separator;c=c.number_decimals;var g=!1,l=" ";wcumcs_vars_data.default_currency==a?(g=!0,l=" disabled"):(g=!1,l=" ");1==g&&(d=wcumcs_vars_data.default_currency_name,e=wcumcs_vars_data.default_currency_symbol,h=wcumcs_vars_data.default_currency_position,f=wcumcs_vars_data.default_currency_thousand_separator,
k=wcumcs_vars_data.default_currency_decimal_separator,c=wcumcs_vars_data.default_currency_number_decimals);if(0<jQuery("tr[data-wcumcs-currency-code='"+a+"']").length)alert(wcumcs_vars_data.currency_already_on_the_list);else{var m=" ",n=" ",p=" ",q=" ";"left"==h?m=" selected":"right"==h?n=" selected":"left_space"==h?p=" selected":"right_space"==h&&(q=" selected");d='<tr data-wcumcs-currency-code="'+a+'">'+('<td><div id="wcumcs_currency_'+a+'_code">'+a+"</div></td>")+('<td><input id="wcumcs_currency_'+
a+'_name" type="text" value="'+d+'"'+l+"/></td>")+('<td><input id="wcumcs_currency_'+a+'_symbol" type="text" value="'+e+'"'+l+" /></td>")+('<td><select id="wcumcs_currency_'+a+'_currency_position"'+l+">");d+='<option value="left"'+m+">"+wcumcs_vars_data.left+" ("+e+"99)</option>";d+='<option value="right"'+n+">"+wcumcs_vars_data.right+" (99"+e+")</option>";d+='<option value="left_space"'+p+">"+wcumcs_vars_data.left_space+" ("+e+" 99)</option>";d+='<option value="right_space"'+q+">"+wcumcs_vars_data.right_space+
" (99 "+e+")</option>";d+="</select></td>";d+='<td><input id="wcumcs_currency_'+a+'_thousand_separator" type="text" value="'+f+'"'+l+" /></td>";d+='<td><input id="wcumcs_currency_'+a+'_decimal_separator" type="text" value="'+k+'"'+l+" /></td>";d+='<td><input id="wcumcs_currency_'+a+'_number_decimals" type="number" value="'+c+'"'+l+" /></td>";d+="<td>";d+='<div><a data-wcumcs-currency-code="'+a+'" class="button" href="#onclick_action" onclick="wcumcs_remove_currency_from_list(this.getAttribute(\'data-wcumcs-currency-code\'));">'+
wcumcs_vars_data.remove_currency+"</a></div>";d+="</td>";jQuery("#wcumcs_currency_table tbody").append(d);wcumcs_update_currencies_list();2>=jQuery("#wcumcs_currency_table tr").length?jQuery("#wcumcs_currency_table tbody").sortable("disable"):jQuery("#wcumcs_currency_table tbody").sortable("enable");jQuery("input[id^=wcumcs_currency_], select[id^=wcumcs_currency_]").on("change",function(){wcumcs_update_currencies_list()});0==b&&0==g&&(b=wcumcs_vars_data.wp_nonce,e={currency_data:{}},e.currency_data[a]=
{},e.currency_data[a].api=wcumcs_vars_data.default_exchange_api,a={action:"wcumcs_ajax",verification:b,execute:"update_exchange_rates",currency_data:e.currency_data},wcumcs_block_screen(!0),jQuery.post(ajaxurl,a,function(a){wcumcs_block_screen(!1)}))}}}
function wcumcs_update_currencies_list(){jQuery("#wcumcs_available_currencies").val("");var a={};jQuery("#wcumcs_currency_table tbody tr").each(function(c){currency_code=this.getAttribute("data-wcumcs-currency-code");currency_name=jQuery("#wcumcs_currency_"+currency_code+"_name").val();currency_symbol=jQuery("#wcumcs_currency_"+currency_code+"_symbol").val();currency_position=jQuery("#wcumcs_currency_"+currency_code+"_currency_position").val();currency_thousand_separator=jQuery("#wcumcs_currency_"+
currency_code+"_thousand_separator").val();currency_decimal_separator=jQuery("#wcumcs_currency_"+currency_code+"_decimal_separator").val();currency_number_decimals=jQuery("#wcumcs_currency_"+currency_code+"_number_decimals").val();a[currency_code]={};a[currency_code].order=c+1;a[currency_code].name=currency_name;a[currency_code].symbol=currency_symbol;a[currency_code].position=currency_position;a[currency_code].thousand_separator=currency_thousand_separator;a[currency_code].decimal_separator=currency_decimal_separator;
a[currency_code].number_decimals=currency_number_decimals});jQuery("#wcumcs_available_currencies").val(JSON.stringify(a))}
function wcumcs_remove_currency_from_list(a){if(2>=jQuery("#wcumcs_currency_table tr").length)return alert(wcumcs_vars_data.too_few_currencies),!1;var c="tr[data-wcumcs-currency-code='"+a+"']";jQuery(c).fadeOut(250,function(){jQuery(c).remove();wcumcs_update_currencies_list();2>=jQuery("#wcumcs_currency_table tr").length&&jQuery("#wcumcs_currency_table tbody").sortable("disable")})}
jQuery(document).ready(function(a){if(0<a("input.wcumcs_exchange_rates").length){a("input.wcumcs_exchange_rates").after('<table class="wcumcs-exchange-rates-table" id="wcumcs_exchange_rates_table"></table>');a("#wcumcs_exchange_rates_table").append('<thead><tr><th class="wcumcs_exchange_cell_code">'+wcumcs_vars_data.currency_code+'</th><th class="wcumcs_exchange_cell_name">'+wcumcs_vars_data.currency_name+'</th><th class="wcumcs_exchange_cell_symbol">'+wcumcs_vars_data.currency_symbol+'</th><th class="wcumcs_exchange_cell_api">'+
wcumcs_vars_data.exchange_api+'</th><th class="wcumcs_exchange_cell_rate">'+wcumcs_vars_data.exchange_rate+'</th><th class="wcumcs_exchange_cell_update wcumcs-center">'+wcumcs_vars_data.update_rate+"</th></tr></thead>");a("#wcumcs_exchange_rates_table").append("<tbody></tbody>");a("#wcumcs_exchange_rates_table").after('<a class="button wcumcs-update-all-button" href="#onclick_action" onclick="wcumcs_update_exchange_rates(\'update_all_exchange_rates\');">'+wcumcs_vars_data.update_all_label+"</a>");
var c=jQuery.parseJSON(a("#wcumcs_inner_use_currencies_in_use").val());a.each(c,function(a){wcumcs_add_new_exchange_rate_row(a,c[a])})}});
function wcumcs_add_new_exchange_rate_row(a,c){var b=c.name,d=c.symbol,e=!1,e=wcumcs_vars_data.default_currency==a?!0:!1;1==e&&(b=wcumcs_vars_data.default_currency_name,d=wcumcs_vars_data.default_currency_symbol);var h=jQuery("#wcumcs_exchange_rate_"+a).val(),f=jQuery("#wcumcs_exchange_api_"+a).val(),b='<tr data-wcumcs-currency-code="'+a+'">'+('<td><div id="wcumcs_exchange_'+a+'_code">'+a+"</div></td>")+('<td><div id="wcumcs_exchange_'+a+'_name">'+b+"</div></td>")+('<td><div id="wcumcs_exchange_'+
a+'_symbol">'+d+"</div></td>")+"<td>";if(wcumcs_vars_data.default_currency==a)b+='<div class="wcumcs_default_exchange_label" id="wcumcs_currency_'+a+'_default_exchange">&mdash;</div>';else{var k=d=" ",g=" ",l=" ",m=" ",n=" ";"yahoo"==f?d=" selected":"ecb"==f?k=" selected":"fixer"==f?g=" selected":"fcca"==f?l=" selected":"google"==f?m=" selected":"techunits"==f&&(n=" selected");b+='<select id="wcumcs_exchange_'+a+'_api">';b+='<option value="yahoo"'+d+">Yahoo Finance</option>";b+='<option value="ecb"'+
k+">European Central Bank</option>";b+='<option value="fixer"'+g+">Fixer.io</option>";b+='<option value="fcca"'+l+">Free Currency Converter API</option>";b+='<option value="google"'+m+">Google Finance</option>";b+='<option value="techunits"'+n+">Techunits Currency Exchange</option>";b+="</select>"}b+="</td>";b+="<td>";b=1==e?b+('<input id="wcumcs_exchange_'+a+'_rate" type="text" value="'+h+'" disabled />'):b+('<input id="wcumcs_exchange_'+a+'_rate" type="text" value="'+h+'" />');b+="</td>";b+='<td class="wcumcs-center">';
b=1==e?b+('<div class="wcumcs_default_exchange_label" id="wcumcs_currency_'+a+'_default_exchange">&mdash;</div>'):b+('<div><a data-wcumcs-currency-code="'+a+'" class="button" href="#onclick_action" onclick="wcumcs_update_exchange_rates(this.getAttribute(\'data-wcumcs-currency-code\'));">'+wcumcs_vars_data.update_label+"</a></div>");b+="</td>";jQuery("#wcumcs_exchange_rates_table tbody").append(b);jQuery("input[id^=wcumcs_exchange_], select[id^=wcumcs_exchange_]").on("change",function(){wcumcs_update_data()})}
function wcumcs_update_exchange_rates(a){var c={},b="";"update_all_exchange_rates"==a?jQuery("#wcumcs_exchange_rates_table > tbody > tr[data-wcumcs-currency-code]").each(function(d){a=jQuery(this).attr("data-wcumcs-currency-code");a==wcumcs_vars_data.default_currency?(c[a]={},c[a].api=wcumcs_vars_data.default_exchange_api):(b="#wcumcs_exchange_"+a+"_api",c[a]={},c[a].api=jQuery(b).val())}):(b="#wcumcs_exchange_"+a+"_api",c[a]={},c[a].api=jQuery(b).val());action_data={name:"update_exchange_rates",
currency_data:{}};action_data.currency_data=c;wcumcs_callback_action(action_data)}
function wcumcs_update_data(){var a=null,c=null,b=null,d=null,e=null;jQuery("#wcumcs_exchange_rates_table > tbody > tr[data-wcumcs-currency-code]").each(function(h){a=jQuery(this).attr("data-wcumcs-currency-code");d="#wcumcs_exchange_"+a+"_rate";e="#wcumcs_exchange_"+a+"_api";c=jQuery(d).val();c=c.replace(",",".");c=parseFloat(c);c!==c&&(c=1);jQuery(d).val(c);b=jQuery(e).val();jQuery("#wcumcs_exchange_rate_"+a).val(c);jQuery("#wcumcs_exchange_api_"+a).val(b)})}jQuery(document).ready(function(a){a("#wcumcs_currency_switcher_text")});
jQuery(document).ready(function(a){if(0<a("input.wcumcs_advanced_additional_restore_defaults_input").length){var c=a("#wcumcs_country_list_data").val(),c=jQuery.parseJSON(c),b='<div id="wcumcs_country_currency_modal" style="display:none;">',b=b+'<table class="wcumcs_countries_currencies_table">',b=b+"<thead><tr>",b=b+('<td class="wcumcs_countries_currencies_first_column"><h4>'+wcumcs_vars_data.country_iso_code+"</h4></td>"),b=b+('<td class="wcumcs_countries_currencies_second_column"><h4>'+wcumcs_vars_data.currency_iso_code+
"</h4></td>"),b=b+"</tr></thead>",b=b+"<tbody>";a.each(c,function(a,c){b+='<tr class="wcumcs_country_currency_row">';b+='<td><input type="text" class="wcumcs_country_currency_country" maxlength="2" value="'+a+'" disabled /></td>';b+='<td><input type="text" class="wcumcs_country_currency_code" maxlength="3" value="'+c+'" /></td>';b+="</tr>"});b+="</tbody>";b+="</table>";b+='<div id="wcumcs_change_country_currency_buttons_wrapper">';b+='<input id="wcumcs_change_country_currency_save_changes_button" name="" class="button-primary" type="submit" value="'+
wcumcs_vars_data.save_changes_button+'" />';b+='<a id="wcumcs_add_country_button" class="button" href="#onclick_action">'+wcumcs_vars_data.add_country_button+"</a>";b+="</div>";b+="</div>";b+='<a class="button thickbox" title="WooCommerce Ultimate Multi Currency Suite" href="#TB_inline?height=600&width=310&inlineId=wcumcs_country_currency_modal">'+wcumcs_vars_data.change_currencies_button+"</a>";a("#wcumcs_country_list_data").after(b);a("#wcumcs_add_country_button").on("click",function(){a(".wcumcs_countries_currencies_table > tbody").append('<tr class="wcumcs_country_currency_row"><td><input type="text" class="wcumcs_country_currency_country" maxlength="2" value="" /></td><td><input type="text" class="wcumcs_country_currency_code" maxlength="3" value="" /></td></tr>');
a("#TB_ajaxContent").scrollTop(a("#TB_ajaxContent")[0].scrollHeight);a("input.wcumcs_country_currency_country:last-of-type").focus()});a("#wcumcs_change_country_currency_save_changes_button").on("click",function(){a("#wcumcs_country_list_data").val("");var b="",c="",h={};a("tr.wcumcs_country_currency_row").each(function(){b=a(this).find("input.wcumcs_country_currency_country").val();c=a(this).find("input.wcumcs_country_currency_code").val();if(""==b||""==c)return!0;h[b]=c});var f=JSON.stringify(h);
a("#wcumcs_country_list_data").val(f);a('#mainform .submit input[name="save"]').click()});c='<a class="button" href="#onclick_action" onclick="wcumcs_callback_action(\'restore_defaults\');">'+wcumcs_vars_data.restore_defaults_button+"</a>";a("input.wcumcs_advanced_additional_restore_defaults_input").after(c)}});
jQuery(document).ready(function(a){if(0<a("div.wcumcs_additional_coupon_values_wrapper").length){switch(a("select[id=discount_type] > option:selected").val()){case "fixed_cart":a("p.wcumcs_additional_coupon_values_not_available").hide();a("div.wcumcs_additional_coupon_values_available_wrapper").show();break;case "fixed_product":a("p.wcumcs_additional_coupon_values_not_available").hide();a("div.wcumcs_additional_coupon_values_available_wrapper").show();break;case "percent":a("p.wcumcs_additional_coupon_values_not_available").show();
a("div.wcumcs_additional_coupon_values_available_wrapper").hide();break;case "percent_product":a("p.wcumcs_additional_coupon_values_not_available").show();a("div.wcumcs_additional_coupon_values_available_wrapper").hide();break;default:a("p.wcumcs_additional_coupon_values_not_available").hide(),a("div.wcumcs_additional_coupon_values_available_wrapper").show()}a("select[id=discount_type]").on("change",function(){switch(a(this).val()){case "fixed_cart":a("p.wcumcs_additional_coupon_values_not_available").hide();
a("div.wcumcs_additional_coupon_values_available_wrapper").show();break;case "fixed_product":a("p.wcumcs_additional_coupon_values_not_available").hide();a("div.wcumcs_additional_coupon_values_available_wrapper").show();break;case "percent":a("p.wcumcs_additional_coupon_values_not_available").show();a("div.wcumcs_additional_coupon_values_available_wrapper").hide();break;case "percent_product":a("p.wcumcs_additional_coupon_values_not_available").show();a("div.wcumcs_additional_coupon_values_available_wrapper").hide();
break;default:a("p.wcumcs_additional_coupon_values_not_available").hide(),a("div.wcumcs_additional_coupon_values_available_wrapper").show()}})}});
jQuery(document).ready(function(a){var c=a("#variable_product_options").find("#variable_product_options_inner").find(".toolbar-top"),b=a(c).find("select.variation_actions"),c=a(c).find("a.do_variation_action"),d="";a.each(wcumcs_vars_data.available_currencies,function(a,b){if(a==wcumcs_vars_data.default_currency)return!0;var c="set_variable_regular_price_"+a.toLowerCase(),k=wcumcs_vars_data.set_regular_prices.replace("%currency_code%",a),g="set_variable_sale_price_"+a.toLowerCase(),l=wcumcs_vars_data.set_sale_prices.replace("%currency_code%",
a);d+='<option value="'+c+'">'+k+"</option>";d+='<option value="'+g+'">'+l+"</option>"});""!=d&&a(b).append('<optgroup label="'+wcumcs_vars_data.multi_currency_prices+'">'+d+"</optgroup>");a(c).on("click",function(){var c=a(b).val(),d=c.lastIndexOf("_"),f=c.substring(d+1).toUpperCase(),c=c.substring(0,d),d="",k=wcumcs_vars_data.enter_a_value.replace("%currency_code%",f);switch(c){case "set_variable_regular_price":case "set_variable_sale_price":d=window.prompt(k)}k="";null!=woocommerce_admin_meta_boxes_variations&&
(k=woocommerce_admin_meta_boxes_variations.post_id);f={bulk_action:c,product_id:k,product_type:a("#product-type").val(),currency_code:f,value:d};a.ajax({url:ajaxurl,data:{action:"wcumcs_ajax",verification:wcumcs_vars_data.wp_nonce,execute:"set_variations_bulk_prices",action_data:f},type:"POST"}).done(function(a){})})});